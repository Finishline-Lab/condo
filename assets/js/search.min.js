$(function(){function e(){$.getJSON("/search.json",function(e){e.type={index:!0},u.postMessage(e),o=e,localStorage.search=JSON.stringify(o),localStorage.updated=(new Date).getTime()})}function t(){return(new Date).getTime()-parseInt(localStorage.updated,10)>864e5?!0:!1}function s(){$("#search-input").val(""),$("#search-container").removeClass("active")}function a(e){i=[],e=e.toLowerCase(),u.postMessage({query:e,type:"search"})}function r(e,t){if($("#search-results").empty(),t.length<1)return void $('<a class="placeholder">No results for <em></em></a>').appendTo("#search-results").find("em").text(e);for(var s=0;s<Math.min(t.length,8);s++){var a=t[s];$('<a href="'+a.url+'"><em>'+a.title+"</em></a>").appendTo("#search-results")}$("#search-results a:first-child").addClass("selected")}function n(){$prev=$("#search-results .selected").prev(),$prev.length<1||($("#search-results .selected").removeClass("selected"),$prev.addClass("selected"))}function c(){$next=$("#search-results .selected").next(),$next.length<1||($("#search-results .selected").removeClass("selected"),$next.addClass("selected"))}function l(){var e=$("#search-results .selected").attr("href");e&&(window.location.href=e)}var o,i,u=new Worker("/assets/js/search_worker.min.js");localStorage.search?(o=JSON.parse(localStorage.search),t()?e():(o.type="index",u.postMessage(o))):e(),$("#search-input").val().length>0&&a($("#search-input").val()),$("#search-input").on("input",function(e){$(this).val().length>0?$("#search-container").addClass("active"):$("#search-container").removeClass("active"),a($(this).val())}),$("body").keyup(function(e){if(83==e.keyCode){if($("#search-input").is(":focus"))return;e.preventDefault(),$("#search-input").focus()}}),$("#search-input").keyup(function(e){27==e.keyCode?(e.preventDefault(),$("#search-input").val().length>0?s():$("#search-input").blur()):13==e.keyCode?(e.preventDefault(),l()):(8==e.keyCode||46==e.keyCode)&&($(this).val().length>0?$("#search-container").addClass("active"):$("#search-container").removeClass("active"),a($(this).val()))}).keydown(function(e){38==e.keyCode?(e.preventDefault(),n()):40==e.keyCode?(e.preventDefault(),c()):27==e.keyCode&&e.preventDefault()}),u.addEventListener("message",function(e){e.data.type.search&&r(e.data.query,e.data.results)}),$("#search-results").on("mouseenter","a",function(e){$(this).parent().find(".selected").removeClass("selected").end().end().addClass("selected")})});